
# 개요
애플리케이션의 수요에 따라 EC2 인스턴스를 자동으로 확장하고 축소하는 기능입니다. 
사용자가 정의한 조정 정책에 따라 인스턴스 수가 증가 되거나 축소 됩니다. 

ex) 
서버의 로드가 증가하면 EC2 인스턴스 개수 추가(Scale out)
서버의 로드가 감소하면 EC2 인스턴스 개수 감소(Scale in)

## Auto Scaling 이점
- 애플리케이션의 수요에 EC2를 자동으로 확장 및 축소하므로 비용 절감 및 수동으로 EC2 용량을 프로비저닝해야 할 필요가 없습니다.
- 손상된 Amazon EC2 인스턴스를 탐지하고 Auto Scaling이 자동으로 교체됩니다.
- 여러 가용 영역을 사용하도록 EC2 Auto Scaling을 구성하여 하나의 가용 영역이 사용 불가 상태가 되면 다른 가용영역에서 새 인스턴스를 시작 
## 구성 요소
- 오토 스케일링 그룹: EC2 인스턴스의 모음
- 시작 템플릿(런치 템플릿): EC2 인스턴스를 시작하기 위한 AMI, 인스턴스 유형, 키 페어, 보안그룹 등의 구성 정보를 가진 템플릿
- 조정 옵션(조정정책): Auto Scaling을 조정하는 조건

## 조정 정책
#### 항상 현재 인스턴스 수준 유지 관리
- 지정된 수의 실행 인스턴스를 항상 유지하도록 Auto Scaling 그룹을 구성합니다.
- 인스턴스가 비정상 상태임을 확인하면 해당 인스턴스를 종료한 다음 새 인스턴스를 시작합니다.
#### 수동 조정
- 최대, 최소 또는 원하는 용량의 변경 사항만 지정하는 경우 사용합니다.
#### 일정을 기반으로 조정(Scheduled Scaling)
- 확장 작업이 시간 및 날짜 함수에 따라 자동으로 수행됩니다.
- 예, 매주 일요일에는 인스턴스 4대, 다른 요일에는 2대 실행합니다.
#### 온디맨드 기반 조정(Dynamic Scaling)
- 수요 변화에 맞춰 Auto Scaling 그룹의 크기를 동적으로 조정합니다.
- 예, CPU 사용량을 50% 기준으로 하고 사용량 기준에 따라 EC2 인스턴스 수를 증가하거나 감소합니다.
#### 예측 조정 사용(Predictive Scaling)
- 머신러닝을 사용하여 CloutWatch의 기록 데이터를 기반으로 용량 필요량을 예측합니다.

## 동적 크기 조정 정책
ASG(Auto Scaling Group)에서 동적 크기 조정 정책을 설정할 수 있습니다.
예를 들어서 **대상 추적 크기 조정**으로 설정 후 지표유형을 평균 CPU 사용률50%로 설정하면 만약 인스턴스들의 평균 CPU가 50% 이하이이면 최소 용량으로 인스턴스를 생성하고, 50% 이상인 경우 최대용량 값에 맞춰서 인스턴스들을 생성 할 수 있습니다.


### 스트레스 테스트 방법
실제 AWS 콘솔에 SSH 프로토콜로 접속해서 하기와 같은 tool을 설치하면 평균 CPU 사용률을 높여서 확인할 수 있습니다.

```sh
sudo yum install stress -y // stress 패키지 설치

stress -c 10  // CPU 코어 10개 사용
```