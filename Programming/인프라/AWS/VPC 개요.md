
# VPC
VPC는 AWS의 가상 네트워크를 의미하고, AWS 서비스의 네트워크 연결을 제어하는 기능입니다.
AWS 계정을 생성하면 기본 VPC 네트워크가 생성됩니다.

AWS VPC를 살펴보기전에 선행지식으로 CIDR(사이더)에 대해서 살펴봤습니다.
기본 VPC는 인터넷과 연결되어 있고, EC2 인스턴스를 생성하면 기본 VPC에 연결됩니다.


![](../../../Attached%20file/AWS%20VPC%20구성도.drawio.png)

## CIDR(Classless Inter-Domain Routing)
 
사이더는 IP주소 범위를 정의하는 방식입니다. IP 주소를 작은 그룹으로 분할 하는 것을 서브네팅이라고 합니다.

ex1) 192.168.32.1/24은 기준 IP, /24는 서브넷 마스크입니다.
192.168.32.1의 IP 대역을 24비트로 나눈것으로, 256개의 IP를 사용가능합니다.(192.168.32.0 ~ 192.168.32.255)

ex2) 192.168.32.1/16(65534개의 IP 사용 가능, 192.168.0.0 ~ 192.168.255.255)
192.168.32.1/25(128개의 IP 사용 가능, 192.168.32.0 ~ 192.168.32.127)

http://www.subnet-calculator.com/cidr.php 에서 자동으로 계산이 가능합니다.
## Security Group(보안그룹)
- 인스턴스에 대한 인바운드 및 아웃바운드 트래픽을 제어하는 가상 방화벽 역할을 합니다.
- 서브넷 수준이 아니라 인스턴스 수준에서 작동(EC2 인스턴스와 ENI와 연결 됩니다.)
- 보안 그룹은 연결 상태를 추적하는 상태저장 방화벽 입니다.
- 보안 그룹은 생성된 VPC 내에서만 사용 가능합니다.

> 하나의 EC2 인스턴스  ENI에 5개까지 보안그룹 연결이 가능합니다. 
> 그리고 보안그룹은 허용규칙만 지정 가능하고 거부 규칙은 지정 할 수 없습니다.


## Network Access Control List(NACL)
- 서브넷 내부와 외부의 트래픽을 제어하는 방화벽입니다.
- 서브넷 레벨의 연결 방화벽입니다.
- 하나의 NACL은 여러 서브넷과 연결 가능 합니다.
- 하나의 서브넷은 하나의 NACL만 연결 가능합니다.
- NACL은 허용, 거부 규칙 모두 지정 가능합니다.
- NACL은 연결상태를 추적하지 않는 상태 비저장 방화벽 입니다.
	- 인바운드 트래픽에 대한 응답은 아웃바운드 트래픽 규칙을 따름
	- 아웃바운드 트래픽에 대한 응답은 인바운드 트래픽 규칙을 따름 


## VPC Peering
- VPC 간에는 기본적으로 네트워크 통신이 되지 않음
- VPC 피어링은 두 VPC 간에 트래픽을 라우팅 할 수 있도록 하기 위한 두 VPC 사이의 네트워킹 연결
- VPC 피어링 트래픽은 퍼블릭 인터넷을 통과하지 않고 프라이빗 IP 주소를 사용하여 서로 통신
- VPC 피어링은 같은 리전 내에, 다른 리전 간, 다른 AWS 계정간 가능합니다.


### VPC Peering 구성

- 요청자가 다른 VPC와 피어링 하기 위한 요청을 생성
- 수락자 VPC의 소유자가 VPC 요청을 수락하여 피어링을 활성화
- 라우팅 테이블에 피어링 연결을 추가


> 참고: [서브넷마스크 개념 정리](../네트워크/서브넷마스크%20개념%20정리.md)


